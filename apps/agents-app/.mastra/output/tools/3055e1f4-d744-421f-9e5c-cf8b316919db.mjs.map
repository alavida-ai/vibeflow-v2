{"version":3,"file":"3055e1f4-d744-421f-9e5c-cf8b316919db.mjs","sources":["../../../src/mastra/tools/workflows/start-workflow.ts"],"sourcesContent":["import { createTool } from \"@mastra/core\";\nimport { z } from \"zod\";\nimport { startWorkflow, StartWorkflowResult, startWorkflowResultSchema } from \"@brand-listener/agent-sdk\";\n\nexport const startWorkflowTool = createTool({\n  id: \"start-workflow\",\n  description: \"Start a workflow and return the first suspend payload (first task). Only one workflow can be active per session.\",\n  inputSchema: z.object({\n    workflowId: z.string()\n  }),\n  outputSchema: startWorkflowResultSchema,\n  execute: async ({ context, runtimeContext }, options) => {\n    // @ts-ignore\n    const mcpSid = options?.extra?.sessionId;       // provided by MCP over Hono SSE\n    console.log(\"appSid\", mcpSid)\n    try {\n      const { workflowId } = context;\n      \n      const result = await startWorkflow(workflowId);\n      runtimeContext.set(\"current-run-id\", result.runId);\n      runtimeContext.set(\"workflowId\", workflowId);\n      console.log(\"result and set runId and workflowId\", result);\n      return result;\n    } catch (error) {\n      throw new Error(`Failed to start workflow: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n});"],"names":[],"mappings":";;;;;AAIO,MAAM,oBAAoB,UAAA,CAAW;AAAA,EAC1C,EAAA,EAAI,gBAAA;AAAA,EACJ,WAAA,EAAa,kHAAA;AAAA,EACb,WAAA,EAAa,EAAE,MAAA,CAAO;AAAA,IACpB,UAAA,EAAY,EAAE,MAAA;AAAO,GACtB,CAAA;AAAA,EACD,YAAA,EAAc,yBAAA;AAAA,EACd,SAAS,OAAO,EAAE,OAAA,EAAS,cAAA,IAAkB,OAAA,KAAY;AAEvD,IAAA,MAAM,MAAA,GAAS,SAAS,KAAA,EAAO,SAAA;AAC/B,IAAA,OAAA,CAAQ,GAAA,CAAI,UAAU,MAAM,CAAA;AAC5B,IAAA,IAAI;AACF,MAAA,MAAM,EAAE,YAAW,GAAI,OAAA;AAEvB,MAAA,MAAM,MAAA,GAAS,MAAM,aAAA,CAAc,UAAU,CAAA;AAC7C,MAAA,cAAA,CAAe,GAAA,CAAI,gBAAA,EAAkB,MAAA,CAAO,KAAK,CAAA;AACjD,MAAA,cAAA,CAAe,GAAA,CAAI,cAAc,UAAU,CAAA;AAC3C,MAAA,OAAA,CAAQ,GAAA,CAAI,uCAAuC,MAAM,CAAA;AACzD,MAAA,OAAO,MAAA;AAAA,IACT,SAAS,KAAA,EAAO;AACd,MAAA,MAAM,IAAI,KAAA,CAAM,CAAA,0BAAA,EAA6B,KAAA,YAAiB,KAAA,GAAQ,MAAM,OAAA,GAAU,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvG;AAAA,EACF;AACF,CAAC;;;;"}