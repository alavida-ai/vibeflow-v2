{"version":3,"file":"876a304a-9212-41ec-8eda-405d6318ddfc.mjs","sources":["../../../src/mastra/tools/workflows/get-next-step.ts"],"sourcesContent":["import { createTool, Tool } from \"@mastra/core\";\nimport { z } from \"zod\";\nimport { getNextStep } from \"@brand-listener/agent-sdk\";\n\n// @ts-ignore\nexport const getNextStepTool: Tool = createTool({\n  id: \"get-next-step\",\n  description: \"Resume the current workflow by marking the previous step as completed and return the next suspend payload (next task). Requires an active workflow started with start-workflow.\",\n  inputSchema: z.object({}), // No input needed - uses runtime context\n  outputSchema: z.object({\n    stepName: z.string().optional(),\n    suspendPayload: z.any().optional(),\n    status: z.enum([\"success\", \"suspended\", \"error\"]),\n    message: z.string().optional(),\n    result: z.any().optional()\n  }),\n  execute: async ({ runtimeContext }) => {\n    try {\n      const result = await getNextStep({\n        runId: runtimeContext.get(\"current-run-id\"),\n        workflowId: runtimeContext.get(\"workflowId\")\n      });\n\n      if (result.status === \"suspended\") {\n        return result;\n      } else if (result.status === \"success\") {\n        runtimeContext.delete(\"current-run-id\");\n        runtimeContext.delete(\"workflowId\");\n        return result;\n      } else {\n        runtimeContext.delete(\"current-run-id\");\n        runtimeContext.delete(\"workflowId\");\n        return result;\n      }\n    } catch (error) {\n      return {\n        status: \"error\" as const,\n        message: `Failed to get next step: ${error instanceof Error ? error.message : String(error)}`\n      };\n    }\n  }\n});"],"names":[],"mappings":";;;;;AAKO,MAAM,kBAAwB,UAAA,CAAW;AAAA,EAC9C,EAAA,EAAI,eAAA;AAAA,EACJ,WAAA,EAAa,iLAAA;AAAA,EACb,WAAA,EAAa,CAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA;AAAA,EACxB,YAAA,EAAc,EAAE,MAAA,CAAO;AAAA,IACrB,QAAA,EAAU,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,IAC9B,cAAA,EAAgB,CAAA,CAAE,GAAA,EAAI,CAAE,QAAA,EAAS;AAAA,IACjC,QAAQ,CAAA,CAAE,IAAA,CAAK,CAAC,SAAA,EAAW,WAAA,EAAa,OAAO,CAAC,CAAA;AAAA,IAChD,OAAA,EAAS,CAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,IAC7B,MAAA,EAAQ,CAAA,CAAE,GAAA,EAAI,CAAE,QAAA;AAAS,GAC1B,CAAA;AAAA,EACD,OAAA,EAAS,OAAO,EAAE,cAAA,EAAe,KAAM;AACrC,IAAA,IAAI;AACF,MAAA,MAAM,MAAA,GAAS,MAAM,WAAA,CAAY;AAAA,QAC/B,KAAA,EAAO,cAAA,CAAe,GAAA,CAAI,gBAAgB,CAAA;AAAA,QAC1C,UAAA,EAAY,cAAA,CAAe,GAAA,CAAI,YAAY;AAAA,OAC5C,CAAA;AAED,MAAA,IAAI,MAAA,CAAO,WAAW,WAAA,EAAa;AACjC,QAAA,OAAO,MAAA;AAAA,MACT,CAAA,MAAA,IAAW,MAAA,CAAO,MAAA,KAAW,SAAA,EAAW;AACtC,QAAA,cAAA,CAAe,OAAO,gBAAgB,CAAA;AACtC,QAAA,cAAA,CAAe,OAAO,YAAY,CAAA;AAClC,QAAA,OAAO,MAAA;AAAA,MACT,CAAA,MAAO;AACL,QAAA,cAAA,CAAe,OAAO,gBAAgB,CAAA;AACtC,QAAA,cAAA,CAAe,OAAO,YAAY,CAAA;AAClC,QAAA,OAAO,MAAA;AAAA,MACT;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,OAAO;AAAA,QACL,MAAA,EAAQ,OAAA;AAAA,QACR,OAAA,EAAS,4BAA4B,KAAA,YAAiB,KAAA,GAAQ,MAAM,OAAA,GAAU,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,OAC7F;AAAA,IACF;AAAA,EACF;AACF,CAAC;;;;"}